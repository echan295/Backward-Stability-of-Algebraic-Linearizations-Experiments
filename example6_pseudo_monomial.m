% load example6.mat

M{1} = [0.6976495685e0 0.6663264885e0; 0.2036764371e0 0.4430660894e0;];
M{2} = [0.270915287449415565e0 0.394970050914480897e0; 0.796312134501556912e0 0.744348625923178520e0;];
M{3} = [-0.253158625100421530e0 -0.617403059424786571e0; -0.117940754051651608e1 0.119685838318589810e0;];
M{4} = [-0.455582187535537586e0 0.557855923004424437e-2; -0.103627400699166650e1 -0.884196138257633768e0;];
M{5} = [-0.160525685373592852e0 0.153298025393391613e1; 0.155591737061930457e1 -0.925521583613477139e0;];
M{6} = [0.691841919786110204e0 -0.514351001920008932e0; 0.595207012442280581e0 0.138699185756098031e1;];
M{7} = [0.490509706788558875e0 -0.995022276545810991e0; -0.566789544940573542e0 0.449133970999145815e0;];
M{8} = [-0.3402620283e0 0.4957128170e0; 0.1343322934e0 -0.5281255347e0;];

[C0, C1, X, Y] = companionMatrix(M);

% plot(eig(C0, C1), 'k.');

x = linspace(-4, 3, 1000);
y = linspace(-0.6, 0.6, 1000);

[x, y] = meshgrid(x, y);

z = zeros(1000);

for i = 1:1000
    for j = 1:1000
        Z = x(i, j) + 1i*y(i, j);
        z(i, j) = min(svd(Z*C1 - C0));
    end
end

contour(x, y, z, logspace(-3, 3, 30), 'showText', 'On')